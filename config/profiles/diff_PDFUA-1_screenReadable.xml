9,78d8
<         <rule object="MainXMPPackage" tags="metadata">
<             <id specification="ISO_14289_1" clause="5" testNumber="1"/>
<             <description>The PDF/UA version and conformance level of a file shall be specified using the PDF/UA Identification extension schema</description>
<             <test>containsPDFUAIdentification == true</test>
<             <error>
<                 <message>The document metadata stream doesn't contain PDF/UA Identification Schema</message>
<                 <arguments/>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDFUAIdentification" tags="metadata">
<             <id specification="ISO_14289_1" clause="5" testNumber="2"/>
<             <description>The value of "pdfuaid:part" shall be the part number of the International Standard to which the file conforms</description>
<             <test>part == 1</test>
<             <error>
<                 <message>The "part" property of the PDF/UA Identification Schema is %1 instead of 1 for PDF/UA-1 conforming file</message>
<                 <arguments>
<                     <argument>part</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDFUAIdentification" tags="metadata">
<             <id specification="ISO_14289_1" clause="5" testNumber="3"/>
<             <description>Property "part" of the PDF/UA Identification Schema shall have namespace prefix "pdfuaid"</description>
<             <test>partPrefix == null || partPrefix == "pdfuaid"</test>
<             <error>
<                 <message>Property "part" of the PDF/UA Identification Schema has invalid namespace prefix %1</message>
<                 <arguments>
<                     <argument>partPrefix</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDFUAIdentification" tags="metadata">
<             <id specification="ISO_14289_1" clause="5" testNumber="4"/>
<             <description>Property "amd" of the PDF/UA Identification Schema shall have namespace prefix "pdfuaid"</description>
<             <test>amdPrefix == null || amdPrefix == "pdfuaid"</test>
<             <error>
<                 <message>Property "amd" of the PDF/UA Identification Schema has invalid namespace prefix %1</message>
<                 <arguments>
<                     <argument>amdPrefix</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDFUAIdentification" tags="metadata">
<             <id specification="ISO_14289_1" clause="5" testNumber="5"/>
<             <description>Property "corr" of the PDF/UA Identification Schema shall have namespace prefix "pdfuaid"</description>
<             <test>corrPrefix == null || corrPrefix == "pdfuaid"</test>
<             <error>
<                 <message>Property "corr" of the PDF/UA Identification Schema has invalid namespace prefix %1</message>
<                 <arguments>
<                     <argument>corrPrefix</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="CosDocument" tags="syntax">
<             <id specification="ISO_14289_1" clause="6.1" testNumber="1"/>
<             <description>The file header shall consist of "%PDF-1.n" followed by a single EOL marker, where 'n' is a single digit number between 0 (30h) and 7 (37h)</description>
<             <test>/^%PDF-1\.[0-7]$/.test(header)</test>
<             <error>
<                 <message>File header %1 does not match the pattern %PDF-1.n, where 'n' is a single digit number between 0 and 7</message>
<                 <arguments>
<                     <argument>header</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
202,214d131
<         <rule object="CosDocument" tags="syntax">
<             <id specification="ISO_14289_1" clause="7.1" testNumber="10"/>
<             <description>The document catalog dictionary shall include a ViewerPreferences dictionary containing a DisplayDocTitle key, whose value shall be true</description>
<             <test>DisplayDocTitle == true</test>
<             <error>
<                 <message>ViewerPreferences dictionary is not present in the document Catalog, or DisplayDocTitle key is set to false or is not present in the ViewerPreferences dictionary (ViewerPreferences = %1, DisplayDocTitle = %2)</message>
<                 <arguments>
<                     <argument>ViewerPreferences</argument>
<                     <argument>DisplayDocTitle</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
721,764d637
<         <rule object="SETable" tags="structure,table">
<             <id specification="ISO_14289_1" clause="7.2" testNumber="41"/>
<             <description>Table columns shall have the same number of rows (taking into account row spans)</description>
<             <test>numberOfColumnWithWrongRowSpan == null</test>
<             <error>
<                 <message>Table columns 1 and %1 span different number of rows</message>
<                 <arguments>
<                     <argument>numberOfColumnWithWrongRowSpan + 1</argument>
<                 </arguments>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="14.8.4.3.4"/>
<             </references>
<         </rule>
<         <rule object="SETable" tags="structure,table">
<             <id specification="ISO_14289_1" clause="7.2" testNumber="42"/>
<             <description>Table rows shall have the same number of columns (taking into account column spans)</description>
<             <test>numberOfRowWithWrongColumnSpan == null || wrongColumnSpan != null</test>
<             <error>
<                 <message>Table rows 1 and %1 span different number of columns</message>
<                 <arguments>
<                     <argument>numberOfRowWithWrongColumnSpan + 1</argument>
<                 </arguments>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="14.8.4.3.4"/>
<             </references>
<         </rule>
<         <rule object="SETable" tags="structure,table">
<             <id specification="ISO_14289_1" clause="7.2" testNumber="43"/>
<             <description>Table rows shall have the same number of columns (taking into account column spans)</description>
<             <test>numberOfRowWithWrongColumnSpan == null || wrongColumnSpan == null</test>
<             <error>
<                 <message>Table rows 1 and %1 span different number of columns (%2 and %3 respectively)</message>
<                 <arguments>
<                     <argument>numberOfRowWithWrongColumnSpan + 1</argument>
<                     <argument>columnSpan</argument>
<                     <argument>wrongColumnSpan</argument>
<                 </arguments>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="14.8.4.3.4"/>
<             </references>
<         </rule>
821,846d693
<         <rule object="SETD" tags="structure,table">
<             <id specification="ISO_14289_1" clause="7.5" testNumber="1"/>
<             <description>If the table's structure is not determinable via Headers and IDs, then structure elements of type TH shall have a Scope attribute</description>
<             <test>hasConnectedHeader != false || unknownHeaders != ''</test>
<             <error>
<                 <message>TD does not contain Headers attribute, and Headers for this table cell cannot be determined algorithmically</message>
<                 <arguments/>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-2:2020" clause="14.8.4.8.3"/>
<             </references>
<         </rule>
<         <rule object="SETD" tags="structure,table">
<             <id specification="ISO_14289_1" clause="7.5" testNumber="2"/>
<             <description>If the table's structure is not determinable via Headers and IDs, then structure elements of type TH shall have a Scope attribute</description>
<             <test>hasConnectedHeader != false || unknownHeaders == ''</test>
<             <error>
<                 <message>TD references undefined Header(s) %1, and Headers for this table cell cannot be determined algorithmically</message>
<                 <arguments>
<                     <argument>unknownHeaders</argument>
<                 </arguments>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-2:2020" clause="14.8.4.8.3"/>
<             </references>
<         </rule>
1110,1283d956
<         </rule>
<         <rule object="PDType0Font" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.3.1" testNumber="1"/>
<             <description>For any given composite (Type 0) font within a conforming file, the CIDSystemInfo entry in its CIDFont dictionary and its Encoding dictionary shall have the following relationship: - If the Encoding key in the Type 0 font dictionary is Identity-H or Identity-V, any values of Registry, Ordering, and Supplement may be used in the CIDSystemInfo entry of the CIDFont. - Otherwise, the corresponding Registry and Ordering strings in both CIDSystemInfo dictionaries shall be identical, and the value of the Supplement key in the CIDSystemInfo dictionary of the CIDFont shall be less than or equal to the Supplement key in the CIDSystemInfo dictionary of the CMap</description>
<             <test>cmapName == "Identity-H" || cmapName == "Identity-V" || (CIDFontOrdering != null &amp;&amp; CIDFontOrdering == CMapOrdering &amp;&amp; CIDFontRegistry != null &amp;&amp; CIDFontRegistry == CMapRegistry &amp;&amp; CIDFontSupplement != null &amp;&amp; CMapSupplement != null &amp;&amp; CIDFontSupplement &lt;= CMapSupplement)</test>
<             <error>
<                 <message>CIDSystemInfo entries the CIDFont and CMap dictionaries of a Type 0 font are not compatible (CIDSystemInfo Ordering = %1, CMap Ordering = %2, CIDSystemInfo Registry = %3, CMap Registry = %4, CIDSystemInfo Supplement = %5, CMap Supplement = %6)</message>
<                 <arguments>
<                     <argument>CIDFontOrdering</argument>
<                     <argument>CMapOrdering</argument>
<                     <argument>CIDFontRegistry</argument>
<                     <argument>CMapRegistry</argument>
<                     <argument>CIDFontSupplement</argument>
<                     <argument>CMapSupplement</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDCIDFont" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.3.2" testNumber="1"/>
<             <description>ISO 32000-1:2008, 9.7.4, Table 117 requires that all embedded Type 2 CIDFonts in the CIDFont dictionary shall contain a CIDToGIDMap entry that shall be a stream mapping from CIDs to glyph indices or the name Identity, as described in ISO 32000-1:2008, 9.7.4, Table 117</description>
<             <test>Subtype != "CIDFontType2" || CIDToGIDMap != null || containsFontFile == false</test>
<             <error>
<                 <message>A Type 2 CIDFont dictionary has missing or invalid CIDToGIDMap entry</message>
<                 <arguments/>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="9.7.4, Table 117"/>
<             </references>
<         </rule>
<         <rule object="PDCMap" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.3.3" testNumber="1"/>
<             <description>All CMaps used within a PDF/UA file, except those listed in ISO 32000-1:2008, 9.7.5.2, Table 118, shall be embedded in that file as described in ISO 32000-1:2008, 9.7.5</description>
<             <test>CMapName == "Identity-H" || CMapName == "Identity-V" || CMapName == "GB-EUC-H" || CMapName == "GB-EUC-V" || CMapName == "GBpc-EUC-H" || CMapName == "GBpc-EUC-V" || CMapName == "GBK-EUC-H" || CMapName == "GBK-EUC-V" || CMapName == "GBKp-EUC-H" || CMapName == "GBKp-EUC-V" || CMapName == "GBK2K-H" || CMapName == "GBK2K-V" || CMapName == "UniGB-UCS2-H" || CMapName == "UniGB-UCS2-V" || CMapName == "UniGB-UFT16-H" || CMapName == "UniGB-UFT16-V" || CMapName == "B5pc-H" || CMapName == "B5pc-V" || CMapName == "HKscs-B5-H" || CMapName == "HKscs-B5-V" || CMapName == "ETen-B5-H" || CMapName == "ETen-B5-V" || CMapName == "ETenms-B5-H" || CMapName == "ETenms-B5-V" || CMapName == "CNS-EUC-H" || CMapName == "CNS-EUC-V" || CMapName == "UniCNS-UCS2-H" || CMapName == "UniCNS-UCS2-V" || CMapName == "UniCNS-UFT16-H" || CMapName == "UniCNS-UTF16-V" || CMapName == "83pv-RKSJ-H" || CMapName == "90ms-RKSJ-H" || CMapName == "90ms-RKSJ-V" || CMapName == "90msp-RKSJ-H" || CMapName == "90msp-RKSJ-V" || CMapName == "90pv-RKSJ-H" || CMapName == "Add-RKSJ-H" || CMapName == "Add-RKSJ-V" || CMapName == "EUC-H" || CMapName == "EUC-V" || CMapName == "Ext-RKSJ-H" || CMapName == "Ext-RKSJ-V" || CMapName == "H" || CMapName == "V" || CMapName == "UniJIS-UCS2-H" || CMapName == "UniJIS-UCS2-V" || CMapName == "UniJIS-UCS2-HW-H" || CMapName == "UniJIS-UCS2-HW-V" || CMapName == "UniJIS-UTF16-H" || CMapName == "UniJIS-UTF16-V" || CMapName == "KSC-EUC-H" || CMapName == "KSC-EUC-V" || CMapName == "KSCms-UHC-H" || CMapName == "KSCms-UHC-V" || CMapName == "KSCms-UHC-HW-H" || CMapName == "KSCms-UHC-HW-V" || CMapName == "KSCpc-EUC-H" || CMapName == "UniKS-UCS2-H" || CMapName == "UniKS-UCS2-V" || CMapName == "UniKS-UTF16-H" || CMapName == "UniKS-UTF16-V" || containsEmbeddedFile == true</test>
<             <error>
<                 <message>A non-standard CMap %1 is not embedded</message>
<                 <arguments>
<                     <argument>CMapName</argument>
<                 </arguments>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="9.7.5.2, Table 118"/>
<             </references>
<         </rule>
<         <rule object="CMapFile" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.3.3" testNumber="2"/>
<             <description>For those CMaps that are embedded, the integer value of the WMode entry in the CMap dictionary shall be identical to the WMode value in the embedded CMap stream</description>
<             <test>WMode == dictWMode</test>
<             <error>
<                 <message>WMode entry (value %1) in the embedded CMap and in the CMap dictionary (value %2) are not identical</message>
<                 <arguments>
<                     <argument>WMode</argument>
<                     <argument>dictWMode</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDReferencedCMap" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.3.3" testNumber="3"/>
<             <description>A CMap shall not reference any other CMap except those listed in ISO 32000-1:2008, 9.7.5.2, Table 118</description>
<             <test>CMapName == "Identity-H" || CMapName == "Identity-V" || CMapName == "GB-EUC-H" || CMapName == "GB-EUC-V" || CMapName == "GBpc-EUC-H" || CMapName == "GBpc-EUC-V" || CMapName == "GBK-EUC-H" || CMapName == "GBK-EUC-V" || CMapName == "GBKp-EUC-H" || CMapName == "GBKp-EUC-V" || CMapName == "GBK2K-H" || CMapName == "GBK2K-V" || CMapName == "UniGB-UCS2-H" || CMapName == "UniGB-UCS2-V" || CMapName == "UniGB-UFT16-H" || CMapName == "UniGB-UFT16-V" || CMapName == "B5pc-H" || CMapName == "B5pc-V" || CMapName == "HKscs-B5-H" || CMapName == "HKscs-B5-V" || CMapName == "ETen-B5-H" || CMapName == "ETen-B5-V" || CMapName == "ETenms-B5-H" || CMapName == "ETenms-B5-V" || CMapName == "CNS-EUC-H" || CMapName == "CNS-EUC-V" || CMapName == "UniCNS-UCS2-H" || CMapName == "UniCNS-UCS2-V" || CMapName == "UniCNS-UFT16-H" || CMapName == "UniCNS-UTF16-V" || CMapName == "83pv-RKSJ-H" || CMapName == "90ms-RKSJ-H" || CMapName == "90ms-RKSJ-V" || CMapName == "90msp-RKSJ-H" || CMapName == "90msp-RKSJ-V" || CMapName == "90pv-RKSJ-H" || CMapName == "Add-RKSJ-H" || CMapName == "Add-RKSJ-V" || CMapName == "EUC-H" || CMapName == "EUC-V" || CMapName == "Ext-RKSJ-H" || CMapName == "Ext-RKSJ-V" || CMapName == "H" || CMapName == "V" || CMapName == "UniJIS-UCS2-H" || CMapName == "UniJIS-UCS2-V" || CMapName == "UniJIS-UCS2-HW-H" || CMapName == "UniJIS-UCS2-HW-V" || CMapName == "UniJIS-UTF16-H" || CMapName == "UniJIS-UTF16-V" || CMapName == "KSC-EUC-H" || CMapName == "KSC-EUC-V" || CMapName == "KSCms-UHC-H" || CMapName == "KSCms-UHC-V" || CMapName == "KSCms-UHC-HW-H" || CMapName == "KSCms-UHC-HW-V" || CMapName == "KSCpc-EUC-H" || CMapName == "UniKS-UCS2-H" || CMapName == "UniKS-UCS2-V" || CMapName == "UniKS-UTF16-H" || CMapName == "UniKS-UTF16-V"</test>
<             <error>
<                 <message>A CMap references another non-standard CMap %1</message>
<                 <arguments>
<                     <argument>CMapName</argument>
<                 </arguments>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="9.7.5.2, Table 118"/>
<             </references>
<         </rule>
<         <rule object="PDFont" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.4.1" testNumber="1"/>
<             <description>The font programs for all fonts used for rendering within a conforming file shall be embedded within that file, as defined in ISO 32000-1:2008, 9.9</description>
<             <test>Subtype == "Type3" || Subtype == "Type0" || renderingMode == 3 || containsFontFile == true</test>
<             <error>
<                 <message>The font program is not embedded</message>
<                 <arguments/>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="9.9"/>
<             </references>
<         </rule>
<         <rule object="Glyph" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.4.1" testNumber="2"/>
<             <description>Embedded fonts shall define all glyphs referenced for rendering within the conforming file. A font referenced solely in text rendering mode 3 is not rendered and is thus exempt from the requirements that impact the visual representation of the glyphs of a font. In all cases for TrueType fonts that are to be rendered, character codes shall be able to be mapped to glyphs according to ISO 32000-1:2008, 9.6.6.4 without the use of a non-standard mapping chosen by the conforming processor</description>
<             <test>renderingMode == 3 || isGlyphPresent == null || isGlyphPresent == true</test>
<             <error>
<                 <message>Not all glyphs referenced for rendering are present in the embedded font program</message>
<                 <arguments/>
<             </error>
<             <references>
<                 <reference specification="ISO 32000-1:2008" clause="9.3.6"/>
<                 <reference specification="ISO 32000-1:2008" clause="9.6.6.4"/>
<             </references>
<         </rule>
<         <rule object="PDType1Font" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.4.2" testNumber="1"/>
<             <description>If the FontDescriptor dictionary of an embedded Type 1 font contains a CharSet string, then it shall list the character names of all glyphs present in the font program, regardless of whether a glyph in the font is referenced or used by the PDF or not</description>
<             <test>containsFontFile == false || fontName.search(/[A-Z]{6}\+/) != 0 || CharSet == null || charSetListsAllGlyphs == true</test>
<             <error>
<                 <message>A CharSet entry in the Descriptor dictionary of a Type1 font incorrectly lists glyphs present in the font program</message>
<                 <arguments/>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDCIDFont" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.4.2" testNumber="2"/>
<             <description>If the FontDescriptor dictionary of an embedded CID font contains a CIDSet stream, then it shall identify all CIDs which are present in the font program, regardless of whether a CID in the font is referenced or used by the PDF or not</description>
<             <test>containsFontFile == false || fontName.search(/[A-Z]{6}\+/) != 0 || containsCIDSet == false || cidSetListsAllGlyphs == true</test>
<             <error>
<                 <message>A CIDSet entry in the Font descriptor does not correctly identify all glyphs present in the embedded font subset</message>
<                 <arguments/>
<             </error>
<             <references/>
<         </rule>
<         <rule object="Glyph" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.5" testNumber="1"/>
<             <description>For every font embedded in a conforming file and used for rendering, the glyph width information in the font dictionary and in the embedded font program shall be consistent</description>
<             <test>renderingMode == 3 || widthFromFontProgram == null || widthFromDictionary == null || Math.abs(widthFromFontProgram - widthFromDictionary) &lt;= 1</test>
<             <error>
<                 <message>Glyph width %1 in the embedded font program is not consistent with the Widths entry of the font dictionary (value %2)</message>
<                 <arguments>
<                     <argument>widthFromFontProgram</argument>
<                     <argument>widthFromDictionary</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="TrueTypeFontProgram" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.6" testNumber="1"/>
<             <description>For all non-symbolic TrueType fonts used for rendering, the embedded TrueType font program shall contain one or several non-symbolic cmap entries such that all necessary glyph lookups can be carried out</description>
<             <test>isSymbolic == true || (cmap30Present == true ? nrCmaps &gt; 1 : nrCmaps &gt; 0)</test>
<             <error>
<                 <message>The embedded font program for a non-symbolic TrueType font does not contain non-symbolic cmap entries</message>
<                 <arguments/>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDTrueTypeFont" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.6" testNumber="2"/>
<             <description>All non-symbolic TrueType fonts shall have either MacRomanEncoding or WinAnsiEncoding as the value for the Encoding key in the Font dictionary or as the value for the BaseEncoding key in the dictionary which is the value of the Encoding key in the Font dictionary. In addition, no non-symbolic TrueType font shall define a Differences array unless all of the glyph names in the Differences array are listed in the Adobe Glyph List and the embedded font program contains at least the Microsoft Unicode (3,1 – Platform ID=3, Encoding ID=1) encoding in the 'cmap' table</description>
<             <test>isSymbolic == true || ((Encoding == "MacRomanEncoding" || Encoding == "WinAnsiEncoding") &amp;&amp; (containsDifferences == false || differencesAreUnicodeCompliant == true))</test>
<             <error>
<                 <message>A non-symbolic TrueType font encoding does not define a correct mapping to the Adobe Glyph List (Encoding = %1, Encoding entry contains a Differences = %2, Differences are Unicode compliant = %3)</message>
<                 <arguments>
<                     <argument>Encoding</argument>
<                     <argument>containsDifferences</argument>
<                     <argument>differencesAreUnicodeCompliant</argument>
<                 </arguments>
<             </error>
<             <references/>
<         </rule>
<         <rule object="PDTrueTypeFont" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.6" testNumber="3"/>
<             <description>Symbolic TrueType fonts shall not contain an Encoding entry in the font dictionary</description>
<             <test>isSymbolic == false || Encoding == null</test>
<             <error>
<                 <message>A symbolic TrueType font specifies an Encoding entry in its dictionary</message>
<                 <arguments/>
<             </error>
<             <references/>
<         </rule>
<         <rule object="TrueTypeFontProgram" tags="font">
<             <id specification="ISO_14289_1" clause="7.21.6" testNumber="4"/>
<             <description>The 'cmap' table in the embedded font program for a symbolic TrueType font shall contain either exactly one encoding or it shall contain, at least, the Microsoft Symbol (3,0 - Platform ID=3, Encoding ID=0) encoding</description>
<             <test>isSymbolic == false || nrCmaps == 1 || cmap30Present == true</test>
<             <error>
<                 <message>The embedded font program for a symbolic TrueType font contains %1 cmap subtables and does not contain Microsoft Symbol (3,0 – Platform ID=3, Encoding ID=0)</message>
<                 <arguments>
<                     <argument>nrCmaps</argument>
<                 </arguments>
<             </error>
<             <references/>
